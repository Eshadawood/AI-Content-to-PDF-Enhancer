<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>AI Content-to-PDF Enhancer (Python)</title>
</head>
<body style="font-family:Arial,Helvetica,sans-serif; padding:40px; max-width:900px;">
  <h1>AI Content-to-PDF Enhancer (Python)</h1>
  <p>Paste a URL and click Enhance â†’ then Download PDF</p>
  <input id="url" placeholder="https://example.com/article" style="width:100%; padding:8px; margin-bottom:8px;" />
  <div style="margin-bottom:8px;">
    <select id="mode"><option value="both">Summarize & Expand</option><option value="summarize">Summarize</option><option value="expand">Expand</option></select>
    <select id="level"><option value="detailed">Detailed</option><option value="brief">Brief</option></select>
    <label><input type="checkbox" id="validate" checked/> Validate claims</label>
  </div>
  <button id="enhance">Enhance</button>
  <pre id="result" style="white-space:pre-wrap; background:#f4f4f4; padding:12px; margin-top:12px;"></pre>
  <button id="download" style="display:none;">Download PDF</button>

  <script>
    document.getElementById('enhance').onclick = async () => {
      const url = document.getElementById('url').value;
      const mode = document.getElementById('mode').value;
      const level = document.getElementById('level').value;
      const validate = document.getElementById('validate').checked;
      const res = await fetch('/api/enhance', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ url, mode, level, validate })
      });
      const data = await res.json();
      document.getElementById('result').textContent = JSON.stringify(data, null, 2);
      document.getElementById('download').style.display = 'inline-block';
      window.__lastPayload = data;
    };
    document.getElementById('download').onclick = async () => {
      const payload = window.__lastPayload;
      if(!payload) return alert('Run Enhance first');
      const r = await fetch('/api/pdf', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
      const blob = await r.blob();
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = (payload.meta.title || 'enhanced') + '.pdf'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
